'use client';

import { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

const testimonials = [
  {
    title: 'SUPPORT YOUR FREELANCE',
    subtitle: 'FREELANCE',
    message: '"Wheel of Work makes my freelance easier thanks to its digital tools. Human relations are one of its great strengths."',
  },
  {
    title: 'BOOST PRODUCTIVITY',
    subtitle: 'TOOLS',
    message: '"This platform saved me hours of planning each week. Absolute game-changer!"',
  },
  {
    title: 'CREATIVE SPACE',
    subtitle: 'DESIGN',
    message: '"A dream come true for creative freelancers looking for freedom and structure."',
  },
  {
    title: 'MANAGE CLIENTS',
    subtitle: 'CRM',
    message: '"Managing clients has never been easier. All tools in one place!"',
  },
  {
    title: 'STAY ORGANIZED',
    subtitle: 'WORKFLOW',
    message: '"Helps me stay focused and organized without any extra effort."',
  },
  {
    title: 'PROJECT CONTROL',
    subtitle: 'DASHBOARD',
    message: '"Real-time tracking of all my ongoing freelance projects is a blessing!"',
  },
  {
    title: 'EASY BILLING',
    subtitle: 'INVOICES',
    message: '"Sending invoices is now as easy as clicking a button. Great UX!"',
  },
  {
    title: 'FREEDOM TO WORK',
    subtitle: 'REMOTE',
    message: '"Gives me the freedom to work from anywhere without losing productivity."',
  },
];

const getVisibleSlides = (width:number) => {
  if (width >= 1280) return 4;
  if (width >= 1024) return 2;
  if (width >= 768) return 2;
  return 1;
};

export default function Section7() {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [visibleSlides, setVisibleSlides] = useState(1);

  useEffect(() => {
    const updateSlides = () => setVisibleSlides(getVisibleSlides(window.innerWidth));
    updateSlides();
    window.addEventListener('resize', updateSlides);
    return () => window.removeEventListener('resize', updateSlides);
  }, []);

  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentIndex((prev) => (prev + visibleSlides) % testimonials.length);
    }, 4000);
    return () => clearInterval(interval);
  }, [visibleSlides]);

  const handleBack = () => {
    setCurrentIndex((prev) =>
      (prev - visibleSlides + testimonials.length) % testimonials.length
    );
  };

  const handleNext = () => {
    setCurrentIndex((prev) => (prev + visibleSlides) % testimonials.length);
  };

  const getVisibleTestimonials = () => {
    return Array.from({ length: visibleSlides }, (_, i) => {
      const index = (currentIndex + i) % testimonials.length;
      return testimonials[index];
    });
  };

  return (
    <section className="bg-black text-white py-16 px-4">
      <div className="flex flex-col md:flex-row items-center justify-between max-w-6xl mx-auto mb-12">
        <h2 className="text-3xl sm:text-4xl md:text-5xl font-bold text-center md:text-left mb-6 md:mb-0">
          WoW STORIES
        </h2>

        <div className="hidden md:flex gap-6">
          <button onClick={handleBack} className="p-2 hover:text-blue-600 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="30" viewBox="0 0 14.921 26.883">
              <path d="M2236.089,3670.3,2224,3682.623l12.089,11.728" transform="translate(-2222.582 -3668.883)" fill="none" stroke="currentColor" strokeLinecap="round" strokeWidth="2" />
            </svg>
          </button>
          <button onClick={handleNext} className="p-2 hover:text-blue-600 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="30" viewBox="0 0 14.921 26.883">
              <path d="M2236.089,3670.3,2224,3682.623l12.089,11.728" transform="translate(2237.503 3695.765) rotate(180)" fill="none" stroke="currentColor" strokeLinecap="round" strokeWidth="2" />
            </svg>
          </button>
        </div>
      </div>

      <div className="flex items-center justify-end gap-4 mb-10 md:hidden">
        <div className="flex gap-1 flex-wrap">
          {Array(testimonials.length).fill(0).map((_, i) => (
            <div key={i} className={`w-6 h-1 ${i === currentIndex ? 'bg-white' : 'border-2 border-gray-700'}`}></div>
          ))}
        </div>
        <button onClick={handleBack} className="w-6 h-6">
          <svg className="fill-white w-full h-full" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
            <path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
          </svg>
        </button>
      </div>

      <AnimatePresence mode="wait">
        <motion.div
          key={currentIndex}
          initial={{ x: 300, opacity: 0 }}
          animate={{ x: 0, opacity: 1 }}
          exit={{ x: -300, opacity: 0 }}
          transition={{ duration: 0.4 }}
          className="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-8"
        >
          {getVisibleTestimonials().map((testimonial, index) => (
            <div
              key={index}
              className="text-white rounded-2xl border border-white p-8 h-[300px] flex flex-col justify-between text-center shadow-lg hover:scale-105 transition-transform duration-300"
            >
              <h4 className="text-lg sm:text-xl md:text-2xl font-semibold mb-4">{testimonial.title}</h4>
              <h6 className="text-sm sm:text-base md:text-lg font-medium mb-4 text-gray-400">{testimonial.subtitle}</h6>
              <p className="text-sm sm:text-base md:text-lg">{testimonial.message}</p>
            </div>
          ))}
        </motion.div>
      </AnimatePresence>
      <div className='flex justify-center mt-20'>
        <svg className='fill-white w-40 md:w-52 xl:w-60' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 468.77 468.21">
                <path d="m100.84,315.81l-71.51,33.68-6.15-14.55,59.92-23.14-.66-1.56-41.52,11.32-4.26-10.08,37.04-21.92-.66-1.56-58.34,26.88-6.15-14.55,73.97-27.86,7.25,17.15-29.88,17.42.44,1.04,33.26-9.41,7.25,17.15Z"></path>
                <path d="m82.9,271.14l-78.35,9.96-1.92-15.11,32.57-4.14-.71-5.6-32.57,4.14-1.92-15.11,78.35-9.96,1.92,15.11-32.57,4.14.71,5.6,32.57-4.14,1.92,15.11Z"></path>
                <path d="m78.78,235.11L.06,228.67l2.42-29.58,13.38,1.1-1.18,14.39,18.33,1.5.85-10.35,13.49,1.11-.85,10.35,20.13,1.65,1.18-14.39,13.38,1.1-2.42,29.57Z"></path>
                <path d="m81.23,206.43L5.06,185.56l7.84-28.62,12.95,3.55-3.82,13.93,17.74,4.86,2.74-10.01,13.06,3.58-2.74,10.01,19.48,5.34,3.82-13.93,12.95,3.55-7.84,28.62Z"></path>
                <path d="m88.98,178.63l-71.16-34.26,6.61-13.72,59.07,28.43,6.26-13.01,12.1,5.82-12.87,26.74Z"></path>
                <path d="m94.96,133.97c-1.6,2.1-3.59,3.1-5.98,3-2.39-.1-5.11-1.29-8.14-3.57-3.04-2.28-6.24-5.56-9.6-9.86-3.62-4.72-6.35-8.93-8.19-12.63-1.84-3.69-2.84-6.96-2.98-9.8-.14-2.84.59-5.31,2.18-7.41,1.62-2.14,3.63-3.16,6.02-3.05,2.39.1,5.1,1.3,8.12,3.6,3.02,2.3,6.2,5.61,9.54,9.94,3.65,4.69,6.4,8.87,8.26,12.55,1.86,3.68,2.86,6.94,3,9.77.14,2.84-.6,5.33-2.22,7.46Zm-5.15-5.74c.48-.63-.03-2.12-1.53-4.47-1.49-2.36-4.31-6.21-8.44-11.56-4.06-5.29-7.03-8.9-8.91-10.82-1.88-1.92-3.06-2.57-3.54-1.94-.45.59.07,2.07,1.55,4.45,1.48,2.37,4.29,6.24,8.42,11.58,4.09,5.26,7.07,8.84,8.96,10.77,1.88,1.92,3.05,2.59,3.5,2Z"></path>
                <path d="m102.14,122.53l-25.47-43.4,12.57-12.76,4.33,7.38-5.99,6.09,6.62,11.19,4.19-4.25,4.38,7.43-4.24,4.3,10.2,17.35-6.58,6.68Z"></path>
                <path d="m137.11,110.97l-41.83-67.07,13.73-7.82,30,56.79,1.47-.84-16.1-39.91,9.51-5.42,26.11,34.21,1.47-.84-33.53-54.78,13.73-7.82,36.34,70.2-16.18,9.21-20.8-27.63-.98.56,13.25,31.93-16.18,9.21Z"></path>
                <path d="m197.47,84.92c-4.16,1.03-8.04.4-11.63-1.89-3.59-2.29-6.85-6.21-9.77-11.76-2.93-5.55-5.46-12.67-7.62-21.36-2.15-8.69-3.23-16.17-3.24-22.45,0-6.28,1.05-11.26,3.15-14.96,2.11-3.7,5.24-6.06,9.4-7.1,4.23-1.05,8.15-.43,11.74,1.86,3.59,2.29,6.83,6.21,9.72,11.77,2.89,5.56,5.41,12.69,7.56,21.37,2.15,8.69,3.25,16.17,3.29,22.43.04,6.27-.99,11.25-3.1,14.95-2.11,3.7-5.28,6.07-9.51,7.12Zm-2.96-11.94c1.24-.31,1.58-2.6,1.03-6.88-.56-4.28-2.1-11.53-4.63-21.75-2.53-10.22-4.55-17.35-6.06-21.4-1.51-4.04-2.88-5.91-4.12-5.6-1.17.29-1.47,2.57-.92,6.85.55,4.28,2.1,11.53,4.63,21.75,2.53,10.22,4.55,17.35,6.06,21.4,1.51,4.04,2.84,5.92,4.01,5.63Z"></path>
                <path d="m215.02,79.15L214.15.17,229.38,0c4.36-.05,8.11.7,11.25,2.24,3.14,1.55,5.57,3.79,7.3,6.75,1.73,2.95,2.61,6.46,2.66,10.52.07,6.24-1.67,11.02-5.2,14.33-3.54,3.31-8.73,5.01-15.57,5.08l-1.81.02-.08-7.33,2.37-.03c1.73-.02,3-.88,3.81-2.58.81-1.7,1.2-4.17,1.16-7.4-.04-3.38-.48-5.9-1.32-7.55-.85-1.64-2.13-2.46-3.86-2.44h-.56s.75,67.36.75,67.36l-15.23.17Zm25.84-.29c-2.03.02-3.47-.53-4.31-1.64-.84-1.12-1.27-3.07-1.31-5.85l-.2-17.94c-.02-2.03-.45-3.49-1.29-4.39-.84-.89-2.12-1.33-3.85-1.31l-1.81.02-.08-7.33,5.98-.07c5.34-.06,9.38,1.21,12.12,3.82,2.74,2.6,4.13,6.31,4.19,11.12l.19,16.92c.01,1.35.27,2.52.77,3.49.5.97,1.16,1.61,2,1.9v1.13s-12.4.14-12.4.14Z"></path>
                <path d="m250.49,78.87L267.34,1.7l14.88,3.25-6.98,31.97,4.41.96,6.98-31.97,14.88,3.25-12.39,31.36-2.14,46.3-16.09-3.51,3.81-33.35-2.2-.48-7.12,32.63-14.88-3.25Z"></path>
                <path d="m314.03,73.99l.34-15.81,12.74-9.54,4.53,2.34-.39,15.91-12.69,9.45-4.53-2.34Z"></path>
                <path d="m323.93,105.9l59.37-52.71,17.88,16.4-47.32,63.77-11.48-10.52,10.53-13.15,5.18-5.81,24.77-31.02-1.08-.99-28.76,27.36-5.51,5.51-12.11,11.7-11.47-10.52Zm19.96-.06l9.57-9.6,7.48,6.86-8.74,10.36-8.32-7.63Z"></path>
                <path d="m361.19,147.69c-2.52-3.65-3.38-7.58-2.59-11.79.8-4.21,3.26-8.68,7.4-13.41,4.14-4.73,9.92-9.66,17.35-14.79,7.43-5.13,14.09-8.79,19.98-10.98,5.89-2.19,10.94-2.92,15.16-2.17,4.22.74,7.58,2.94,10.11,6.6,1.97,2.85,2.9,5.93,2.81,9.23-.09,3.31-1.19,6.58-3.3,9.82-2.11,3.24-5.14,6.22-9.1,8.96-1.36.94-2.83,1.79-4.4,2.56-1.58.77-2.9,1.29-3.98,1.58l-7.88-11.42c.89-.43,1.75-.91,2.57-1.44.82-.52,1.52-.98,2.07-1.36,4.64-3.21,7.79-5.63,9.44-7.27,1.65-1.64,2.14-2.96,1.45-3.95-.51-.74-1.69-.82-3.52-.24-1.84.58-4.49,1.98-7.94,4.18-3.46,2.21-8.16,5.36-14.1,9.46-5.94,4.1-10.56,7.38-13.85,9.83-3.29,2.45-5.53,4.44-6.73,5.95-1.2,1.51-1.54,2.64-1.03,3.38.64.93,1.96.95,3.96.08,2-.88,5.17-2.81,9.5-5.8.43-.3.93-.67,1.5-1.1.57-.44,1.23-.96,1.99-1.58l-.75,1.89-6.47-9.38,8.82-6.09,13.4,19.41c-.86,1.14-2.19,2.59-4,4.34-1.81,1.75-3.7,3.31-5.68,4.68-4.52,3.12-8.88,5.24-13.09,6.36-4.21,1.12-7.95,1.19-11.23.21-3.28-.98-5.91-2.89-7.87-5.74Z"></path>
                <path d="m371.55,160.89l72.77-30.7,11.53,27.34-12.37,5.22-5.61-13.31-16.94,7.15,4.03,9.56-12.47,5.26-4.04-9.56-18.61,7.85,5.61,13.31-12.37,5.22-11.53-27.34Z"></path>
                <path d="m383.02,186.81l77.63-14.55,2.85,15.19-54.95,21.66.33,1.77,55.84-16.89,2.91,15.53-77.63,14.55-2.87-15.3,54.95-21.66-.31-1.66-55.84,16.89-2.91-15.53Z"></path>
                <path d="m389.34,233.32l65.48,3.06.54-11.5,13.41.63-1.79,38.32-13.41-.63.54-11.5-65.48-3.06.72-15.33Z"></path>
                <path d="m382.26,274.1c.92-3.41,2.52-6.21,4.79-8.4s5.02-3.65,8.26-4.37c3.23-.72,6.67-.59,10.3.39,1.45.39,2.98.93,4.59,1.6,1.61.67,2.78,1.26,3.5,1.77l-3.6,13.29c-.85-.31-1.76-.61-2.73-.92-.97-.3-1.86-.56-2.65-.78-3.34-.91-5.86-1.32-7.56-1.23-1.7.08-2.71.71-3.02,1.87-.26.94.03,1.76.86,2.45.82.69,2.18,1.29,4.07,1.8,2.9.79,5.76.8,8.58.05,2.82-.76,6.37-2.15,10.66-4.18,3.5-1.7,6.51-3.03,9.03-3.98,2.52-.95,5.34-1.57,8.45-1.86,3.12-.29,6.34.03,9.68.93,4.06,1.1,7.46,2.8,10.19,5.1,2.73,2.3,4.59,5,5.57,8.12.99,3.11,1.02,6.37.09,9.79-.92,3.41-2.56,6.22-4.92,8.43-2.35,2.21-5.21,3.63-8.58,4.28-3.37.64-6.87.48-10.5-.51-1.38-.37-2.75-.86-4.1-1.46-1.36-.6-2.47-1.18-3.33-1.72l3.6-13.29c.85.31,1.76.61,2.73.92.97.3,1.85.56,2.65.78,3.27.89,5.77,1.29,7.5,1.22,1.73-.08,2.76-.69,3.07-1.85.26-.94-.15-1.79-1.21-2.55-1.06-.76-2.77-1.45-5.14-2.09-3.63-.99-7.16-1.18-10.59-.59-3.43.59-7.72,1.78-12.89,3.58-3.1,1.89-5.8,3.32-8.11,4.29-2.31.97-4.84,1.65-7.59,2.03-2.76.38-5.66.16-8.7-.66-3.49-.95-6.38-2.51-8.68-4.69-2.3-2.18-3.83-4.78-4.58-7.79-.75-3.01-.65-6.26.29-9.74Z"></path>
                <path d="m391.08,306.81l35.39,35.78-4.2,7.2c-1.49,2.56-3.46,4.13-5.89,4.72-2.43.59-5.28.04-8.53-1.64-3.25-1.68-6.81-4.46-10.66-8.31-4.05-4.08-7.17-7.79-9.34-11.12-2.18-3.34-3.44-6.46-3.78-9.36-.34-2.91.26-5.68,1.8-8.32l5.22-8.93Zm.67,14.14c-.42.72-.34,1.65.25,2.8.59,1.15,1.69,2.66,3.3,4.54,1.61,1.88,3.94,4.38,7,7.5,3.04,3.06,5.47,5.37,7.28,6.94,1.82,1.57,3.22,2.58,4.22,3.03,1,.45,1.71.31,2.13-.41l.21-.36-24.18-24.41-.21.36Z"></path>
                <path d="m379.08,328.05l30.57,39.98-11.13,14.48-5.2-6.8,5.42-7.04-7.11-9.32-3.89,5.06-5.25-6.84,3.89-5.06-7.82-10.22-5.42,7.05-5.19-6.8,11.13-14.47Z"></path>
                <path d="m338.9,348.24l41.74,50.55,8.87-7.33,8.55,10.35-29.58,24.43-8.55-10.35,8.87-7.33-41.74-50.55,11.83-9.77Z"></path>
                <path d="m323.49,361.99l29.08,73.88-21.54,11.15-43.61-66.36,13.83-7.16,8.73,14.41,3.68,6.86,20.61,33.93,1.3-.67-15.8-36.42-3.28-7.07-6.82-15.4,13.83-7.16Zm-6.81,18.77l5.72,12.28-9.02,4.67-6.72-11.77,10.02-5.19Z"></path>
                <path d="m289.3,379.16l21.55,75.98-14.65,4.15-17.88-63.07-13.89,3.94-3.66-12.92,28.55-8.1Z"></path>
                <path d="m261.88,386.83l7.08,78.66-29.55,2.66-1.2-13.37,14.38-1.29-1.65-18.32-10.34.93-1.21-13.48,10.34-.93-1.81-20.12-14.38,1.29-1.2-13.37,29.55-2.66Z"></path>
                <path d="m233.72,389.85l-9.95,78.35-15.33-1.95-3.77-58.94-1.79-.23-1.04,58.33-15.67-1.99,9.95-78.35,15.45,1.96,3.77,58.94,1.68.21,1.04-58.33,15.67,1.99Z"></path>
                <path d="m187.48,381.61l-22.84,61.45,10.79,4.01-4.68,12.59-35.96-13.36,4.68-12.59,10.79,4.01,22.84-61.45,14.38,5.35Z"></path>
                <path d="m150.76,362.49c2.97,1.92,5.15,4.29,6.55,7.12,1.4,2.83,1.95,5.89,1.65,9.19-.3,3.3-1.46,6.53-3.5,9.69-.82,1.26-1.79,2.56-2.92,3.89-1.13,1.33-2.04,2.26-2.74,2.79l-11.56-7.47c.55-.72,1.12-1.49,1.7-2.32.58-.83,1.1-1.6,1.55-2.29,1.88-2.91,3.03-5.18,3.47-6.83.44-1.64.15-2.79-.86-3.45-.82-.53-1.69-.51-2.6.07-.91.58-1.89,1.69-2.96,3.33-1.63,2.53-2.51,5.25-2.65,8.16-.13,2.91.11,6.72.75,11.43.56,3.85.91,7.12,1.05,9.81.14,2.69-.12,5.56-.8,8.62-.67,3.06-1.95,6.04-3.83,8.94-2.28,3.54-4.94,6.26-7.96,8.16-3.02,1.9-6.16,2.85-9.43,2.84-3.26,0-6.38-.96-9.35-2.88-2.97-1.92-5.15-4.33-6.54-7.24-1.39-2.91-1.88-6.07-1.47-9.48.41-3.41,1.63-6.69,3.67-9.85.78-1.2,1.66-2.36,2.64-3.47.99-1.11,1.87-1.99,2.65-2.65l11.56,7.47c-.55.72-1.12,1.49-1.7,2.33-.58.83-1.1,1.6-1.55,2.29-1.84,2.84-2.98,5.1-3.44,6.78-.45,1.68-.18,2.84.83,3.49.82.53,1.75.4,2.8-.38,1.04-.78,2.23-2.2,3.56-4.26,2.04-3.16,3.3-6.47,3.78-9.91.48-3.44.65-7.9.51-13.37-.86-3.52-1.4-6.53-1.63-9.03-.22-2.49-.1-5.11.37-7.85.47-2.74,1.57-5.44,3.28-8.09,1.96-3.03,4.33-5.32,7.11-6.84,2.78-1.53,5.71-2.19,8.81-1.99,3.09.2,6.16,1.28,9.19,3.24Z"></path>
                <path d="m103.46,355.47l-5.9,14.68-15.28,4.44-3.42-3.79,5.98-14.75,15.2-4.37,3.42,3.79Z"></path>
            </svg>
      </div>
    </section>
  );
}
